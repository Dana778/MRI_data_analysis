# Аннотация

С развитием информационных технологий анализ медицинских изображений все
активнее применяется в диагностике заболеваний. МРТ --- это неинвазивный
метод исследования мягких тканей, основанный на воздействии магнитного
поля и радиочастотных импульсов. Исследования показывают, что МРТ может
быть полезен для ранней диагностики заболеваний, однако точность
автоматизированных методов интерпретации остаётся открытым вопросом.

Целью настоящей работы являлась проверка гипотезы о том, что с помощью
дискретной кривизны графа, построенного на основе корреляционной матрицы
активностей различных областей мозга, полученной с использованием
функциональной МРТ (фМРТ), возможно выявлять лёгкие когнитивные
нарушения с точностью выше 70%.

Проведённое исследование показало, что на текущем этапе дискретная
кривизна уступает по точности другим использованным методикам, которые
продемонстрировали более высокую валидность.

# Ключевые слова

Дискретная кривизна, кривизна Формана--Риччи, кривизна Олливье--Риччи,
графы мозга, функциональная МРТ, матрица корреляций, топология сетей,
анализ данных, метрики расстояния, кластеризация

# Введение

Современные методы анализа медицинских изображений, в частности
функциональной магнитно-резонансной томографии (фМРТ), активно
используются в задачах ранней диагностики когнитивных нарушений. Особое
внимание уделяется исследованию функциональных связей между отделами
мозга, которые можно представить в виде графов, где вершины
соответствуют мозговым регионам, а рёбра --- степени корреляции между
ними. Такой подход позволяет применять методы теории графов и сетевого
анализа для выявления патологий.

В рамках настоящей работы рассматривалась гипотеза о том, что дискретная
кривизна графов, построенных на основе корреляционных матриц активности
мозга, может служить информативным признаком для автоматического
распознавания лёгких когнитивных нарушений (MCI). Изучались два типа
кривизн: Формана--Риччи и Олливье--Риччи. В качестве данных
использовался набор фМРТ-изображений из открытого датасета OASIS-3, из
которого были отобраны 377 респондентов в возрасте от 42 до 95 лет ---
293 здоровых и 84 с различными когнитивными отклонениями.

Для каждого респондента был построен функциональный граф, рассчитаны
значения кривизн и выполнено сравнение между группами, а также попытки
кластеризации на основе полученных признаков. Несмотря на наличие
отдельных статистически значимых различий до поправки на множественные
проверки, общая точность классификации оказалась недостаточной
(наилучшие метрики качества кластеризации после корректировки ARI ≈
0.03, NMI ≈ 0.01), что не позволяет считать текущий метод
конкурентоспособным по сравнению с существующими подходами.

Тем не менее, проведённый анализ позволяет оценить применимость
дискретной кривизны для анализа мозговых сетей и намечает направления
для дальнейшего исследования: улучшение построения графов,
альтернативная векторизация признаков и объединение с другими методами
анализа фМРТ.

# Обзор литературы

Рассмотрение темы началось со статьи (M. O. Zubrikhinaa 2023),
посвященной диагностике легких когнитивных нарушений (MCI) на основе
МРТ-изображений. В работе рассматриваются морфометрические
характеристики мозга --- количественные параметры, такие как объем,
площадь и толщина коры. Авторы использовали Т1-взвешенные [^1] МРТ-сканы
и выявили ключевые морфометрические показатели. Наилучший результат был
получен с использованием метода опорных векторов (SVM)[^2], который
обеспечил точность 73%. Полученные данные подтверждают структурные
изменения мозга при MCI и демонстрируют потенциал машинного обучения в
ранней диагностике когнитивных нарушений. Настоящая работа направлена на
изучение возможности повышения точности классификации с использованием
альтернативных методов.

Статья  (Samal A. 2022) рассматривает применение кривизны Риччи для
выявления различий в функциональных связях мозга у людей с
расстройствами аутистического спектра (РАС). Мозг рассматривается как
сеть, состоящая из разных участков (вершин), которые связаны между собой
корреляцией (ребра) -- это есть функциональная сеть. Авторы обнаружили
статистически значимые различия (p \< 0.001 после поправки на
множественные сравнения) в средних значениях кривизны между группами РАС
и типично развивающимися контролями, а также выделили специфические
регионы мозга, где эти различия наиболее выражены. Подход основан на
геометрическом представлении сложных сетей, позволяющем моделировать
связи в различных областях. За основу взята идея представления сетей как
геометрических объектов (в данном случае графов), что дополняет
традиционные статистические и комбинаторные методы. Для изучения этих
подходов были рассмотрены работы  (Areejit Samal 2018), (Chien-Chun Ni
and Gao 2019) и видеолекции, подробные выкладки будут представлены ниже.

Исследование Samal  (Areejit Samal 2018) проводит сравнительный анализ
кривизны Формана и Оливье в сложных сетях, демонстрируя их высокую
корреляцию. Это подтверждает взаимодополняемость подходов и обосновывает
выбор кривизны как инструмента для выявления структурно значимых связей
в биологических сетях. Работа Robertson (J. 2024) углубляет
теоретическое понимание дискретных кривизин на древовидных структурах,
предоставляя явные формулы для кривизны Оливье, Лин-Лу-Яу и
Штайнербергера. Хотя функциональные сети мозга не являются деревьями,
полученные результаты формируют методологическую базу для анализа
иерархических компонентов нейросетей и их устойчивости к разрывам
связей. Сравнительный аспект работы подчёркивает универсальность
геометрического подхода для сетей различной топологии.

Далее была изучена работа  (Weber M. 2019), в которой также предложен
геометрический подход к анализу функциональных сетей мозга на основе
кривизны Формана--Риччи. Для построения функциональных сетей здесь
используется метод "Task-related Edge Density" (TED)[^3], который
позволяет анализировать изменения в синхронизации между различными
областями мозга во время выполнения задач. В статье изучается, есть ли
зависимость между плотностью рёбер, которая говорит о частоте и
интенсивности изменений связей, и кривизной, которая отображает
структурную значимость связей в масштабах всей сети. Вместе плотность и
кривизна помогают понять, какие связи важны не только количественно, но
и качественно. В результате выявлены области мозга с высокой и низкой
кривизной, которые могут быть связаны с различными когнитивными
процессами. Работа демонстрирует, что геометрические методы, основанные
на кривизне, расширяют традиционный анализ сетей, позволяя изучать не
только топологию, но и устойчивость связей в контексте когнитивных
процессов.

Для ознакомления с исходными данными, использованными в настоящем
исследовании, была изучена документация к датасету OASIS-3,
представленная в работе (OASIS-3 Consortium 2022). Датасет включает
структурные и функциональные МРТ-сканы 1379 респондентов в возрасте от
42 до 95 лет, собранные в рамках продольного наблюдения за когнитивным
здоровьем. Данные были получены в Вашингтонском университете (St. Louis,
Missouri, USA) и включают обследования как здоровых людей, так и
пациентов с различными стадиями когнитивных нарушений. Все персональные
данные респондентов были удалены в соответствии с протоколами
анонимизации, а уникальные идентификаторы заменены случайными кодами,
исключающими возможность восстановления личности участников. Датасет
содержит несколько типов МРТ-изображений, включая:

- Т1-взвешенные (T1w) и Т2-взвешенные (T2w) изображения, используемые
  для анализа морфометрических характеристик мозга;

- Диффузионно-тензорную визуализацию (DTI) для оценки структурных связей
  между областями мозга;

- Функциональную МРТ (fMRI), включая Task-based и Resting-state BOLD
  (Blood Oxygen Level Dependent) сканы, которые применяются для
  исследования функциональных сетей головного мозга.

В рамках данной работы использовались функциональные МРТ-сканы Task-rest
BOLD, поскольку они позволяют анализировать функциональные связи между
областями мозга в состоянии покоя, что имеет ключевое значение для
изучения различий между когнитивно здоровыми людьми и пациентами с
легкими когнитивными нарушениями.

# Теоретические выкладки

## Способы дискретизации кривизны

**Кривизна Риччи** --- это понятие из **римановой геометрии**, которое
описывает, как искажается объём в многообразии вдоль геодезических.
Классическая кривизна Риччи определена только для гладких многообразий и
требует дифференциальной структуры. Для анализа сетей, графов и других
дискретных структур потребовалось адаптировать кривизну Риччи.

Существует несколько интерпритаций дискретной кривизны графов  (J.
2024). Два основных подхода --- Робина Формана и Янна Оливье ---
обобщают свойства классической кривизны Риччи.

**Кривизна Оливье -- Ричи.** Оливье предложил обобщение кривизны Риччи
через теорию оптимального транспорта. Оригинальная задача оптимальной
транспортировки была предложена Г. Монжем в 1781 году и заключалась в
том, чтобы минимизировать стоимость транспортировки железной руды из
различных шахт в набор фабрик, которые обрабатывают руду (Chien-Chun Ni
and Gao 2019). Если точки шахт и фабрик -- это пространства $X$ и $Y$, а
стоимость перевозки между точками $x$ и $y$ задаётся функцией
$c(x,y)=d(x,y)$, то минимальное транспортное расстояние соответствует
расстоянию Васерштейна:
\[W(m_x, m_y) = \inf_{\mu_{x,y} \in \prod(m_x, m_y)(x', y') \in V \times V} \sum_{y' \in V} d(x', y') \mu_{x,y}(x', y'),\[
где $\Pi(m_x, m_y)$ --- множество вероятностных мер $\mu_{x,y}$,
удовлетворяющих условиям:
\[\sum_{y' \in V} \mu_{x,y}(x', y') = m_x(x'), \quad \sum_{x' \in V} \mu_{x,y}(x', y') = m_y(y')\[
Здесь $m_x$ и $m_y$ --- это вероятностные меры, ассоциированные с
точками $x \in X$ и $y \in Y$. Эти меры представляют собой распределения
вероятности на пространствах $X$ и $Y$ и описывают вероятности попадания
в различные элементы этих пространств. Например, для каждой точки
$x \in X$, мера $m_x$ определяет вероятность того, что элемент в
пространстве $X$ будет находиться в окрестности точки $x$. Аналогично,
$m_y$ для точки $y \in Y$ задаёт вероятность нахождения элемента в
окрестности точки $y$ в пространстве $Y$.

На основе этого расстояния Оливье определяет кривизну как:
        \kappa_{xy} = 1 - \frac{W(m_x, m_y)}{d(x, y)}.\[ Эти формулы
взяты из статьи (Areejit Samal 2018).

Оливье иллюстрирует этот подход на примере сферы: две точки $x$ и $y$,
соединённые геодезической, окружены шарами $B_x$ и $B_y$ радиуса
$\varepsilon$. При параллельном переносе шара $B_x$ на шар $B_y$ среднее
расстояние между соответствующими точками определяется выражением:

\[\delta \left( 1 - \frac{\varepsilon^2}{2(n+2)} \text{Ric}(\nu) + O(\varepsilon^3 + \varepsilon^2 \delta) \right),\[
где $d(x, y) = \delta$, а $\varepsilon, \delta \to 0$ (Chien-Chun Ni and
Gao 2019).

Шары задаются объемными мерами, что позволяет сравнивать расстояние
между их центрами и соответствующими мерами с помощью метрики
Васерштейна $W_1$, на основе которой определяется **кривизна
Оливье-Риччи**:

\[\kappa(x, y) = 1 - \frac{W_1(m_x, m_y)}{d(x, y)}.\[

Для вычисления кривизны Оливье каждой точке $x$ сопоставляется
        m_{x}^{\alpha, p} (x_i) =
        \begin{cases} 
        \alpha, & \text{если } x_i = x, \\
        \frac{1-\alpha}{C} \cdot \exp\left(-d(x, x_i)^p\right), & \text{если } x_i \in \pi(x), \\
        0, & \text{иначе}.
        \end{cases}\[

где $C = \sum\limits_{x_i \in \pi(x)} \exp\left(-d(x, x_i)^p\right)$ ---
нормировочный коэффициент, а $\pi(x)$ --- множество соседей вершины $x$.
Параметр $\alpha$ определяет вероятность остаться в $x$, а $p$
регулирует влияние соседей в зависимости от расстояния: при $p=0$
распределение становится равномерным на всех соседях $x$, а при больших
значениях $p$ удаленные соседи теряют в весе значительно (Chien-Chun Ni
and Gao 2019).

**Кривизна Формана -- Риччи.** Определение Формана отличается от Оливье
тем, что он работает с взвешенными CW-клеточными комплексами (Areejit
Samal 2018). Для графа с рёбрами $e = (v_1, v_2)$ и весами на вершинах и
рёбрах $\omega(v_1)$, $\omega(v_2)$, $\omega(e)$ кривизна Формана
        Ric_F(e) = w_e \left( \frac{w_{v_1}}{w_e} + \frac{w_{v_2}}{w_e} - \sum_{e_{v_1} \sim e, e_{v_2} \sim e} \left( \frac{w_{v_1}}{\sqrt{w_e w_{e_{v_1}}}} + \frac{w_{v_2}}{\sqrt{w_e w_{e_{v_2}}}} \right) \right)\[
Рёбра, соединяющие вершины с высокой степенью, имеют очень отрицательные
значения кривизны, что может свидетельствовать о их важности для
целостности сети и формирования её "каркаса" (Weber M. 2019).

## Метрики

Для количественной оценки степени несходства между респондентами,
представленными векторами характеристик кривизны их мозговых сетей, был
применен набор разнообразных метрик расстояния. Выбор различных метрик
был продиктован необходимостью всестороннего исследования структуры
данных, поскольку разные метрики акцентируют внимание на разных аспектах
различий между векторами признаков. В данном исследовании были
использованы следующие метрики:

Метрики семейства $L_p$, такие как **Манхэттенское расстояние** ($L_1$)
и **Евклидово расстояние** ($L_2$), были включены как стандартные
подходы к измерению геометрической близости в пространстве признаков.
        d_{\text{euclidean}}(x, y) = \sqrt{\sum_{i=1}^{n} (x_i - y_i)^2},\[
чувствительно к абсолютным величинам различий в значениях кривизны по
всем регионам мозга и часто используется в задачах кластеризации в
качестве базовой метрики.

    d_{\text{manhattan}}(x, y) = \sum_{i=1}^{n} |x_i - y_i|,\[ менее
чувствительно к отдельным большим выбросам (по сравнению с $L_2$) и
может быть более предпочтительным в пространствах высокой размерности.

    d_{\text{minkowski}}(x, y) = \left( \sum_{i=1}^{n} |x_i - y_i|^p \right)^{1/p}, \quad p=3,\[
было добавлено для исследования промежуточного варианта между $L_2$ и
метриками более высокого порядка, позволяя оценить влияние степени $p$
на структуру расстояний.

Для оценки сходства паттернов кривизны между респондентами, независимо
от их общей амплитуды, была применена метрика, основанная на корреляции.

**Корреляционное расстояние**, основанное на коэффициенте корреляции
        d_{\text{correlation}}(x, y) = 1 - \frac{\sum_{i=1}^{n} (x_i - \bar{x}) (y_i - \bar{y})}{\sqrt{\sum_{i=1}^{n} (x_i - \bar{x})^2} \sqrt{\sum_{i=1}^{n} (y_i - \bar{y})^2}},\[
также оценивает линейную взаимосвязь между профилями кривизны, но после
центрирования данных (вычитания среднего). Это делает его инвариантным к
сдвигу и масштабу данных и полезным для выявления сходства формы
вариаций признаков.

    d_{\text{canberra}}(x, y) = \sum_{i=1}^{n} \frac{|x_i - y_i|}{|x_i| + |y_i|},\[
представляющее собой взвешенную версию Манхэттенского расстояния. Эта
метрика придает больший вес различиям при малых значениях признаков и
полезна для выявления тонких различий в регионах с низкой кривизной,
хотя и чувствительна к нулевым значениям.

Использование этого набора метрик позволило провести комплексный анализ
межобъектных расстояний, учитывая как абсолютные значения кривизн, так и
относительные паттерны их распределения по областям мозга, что является
важным этапом для последующей кластеризации данных (Москин
2021), (Хачумов 2012).

## Методы кластеризации

Для выявления потенциальных групп (кластеров) среди респондентов на
основе вычисленных матриц расстояний были использованы три различных
алгоритма кластеризации, представляющие разные подходы к задаче. Выбор
этих методов обусловлен их различными свойствами и предположениями о
структуре данных:

- **K-means (K-средних)**:

  Один из наиболее распространенных алгоритмов, основанный на разделении
  данных на $k$ кластеров путем минимизации суммы квадратов расстояний
  от точек до центроидов их кластеров. Предполагает наличие кластеров
  выпуклой формы и примерно одинакового размера. В данном исследовании
  $k$ варьировалось от 2 до 4. Алгоритм был реализован с использованием
  библиотеки `sklearn.cluster`.

- **K-Medoids (PAM - Partitioning Around Medoids)**:

  Вариация K-means, которая в качестве центров кластеров (медоидов)
  использует реальные точки из набора данных, а не средние значения. Это
  делает алгоритм более устойчивым к шуму и выбросам по сравнению с
  K-means. Реализация была взята из библиотеки `sklearn_extra.cluster`.

- **HDBSCAN (Hierarchical Density-Based Spatial Clustering of
  Applications with Noise)**:

  Иерархический плотностной алгоритм кластеризации, который расширяет
  DBSCAN, преобразуя его в иерархический алгоритм, а затем используя
  метод выделения плоских кластеров из иерархии. Он не требует
  предварительного задания количества кластеров, способен обнаруживать
  кластеры произвольной формы и идентифицировать шумовые точки.
  Использовалась специализированная библиотека `hdbscan`.

Применение этих трех методов позволило исследовать данные с
использованием различных парадигм кластеризации: центроидной (K-means),
медоидной (K-Medoids) и плотностной (HDBSCAN).

# Ход работы и методы

## Теоретическая подготовка

На начальном этапе исследования был осуществлен анализ научной
литературы, направленный на изучение теоретических основ концепции
дискретной кривизны. В рамках данного анализа были рассмотрены различные
типы кривизны и их применения в медицине. Был проведен анализ
существующих проектов, в которых кривизна использовалась для изучения
структур данных и их топологических свойств. Детальные результаты
проведенного анализа представлены в разделах "Обзор литературы" и
"Теоретические выкладки" настоящего исследования.

## Подготовка данных

После изучения теоретической базы была проведена практическая реализация
исследования. Данные были получены из базы OASIS-3 и включали BOLD-fMRI
(Blood Oxygen Level Dependent) измерения в режимах extittask (выполнение
задачи) и extitrest (состояние покоя). Данные позволяли анализировать
корреляционные связи между отделами мозга в различных состояниях.
Исходные временные ряды представляли собой показатели активности
мозговых регионов, размеченных согласно атласу AAL-3. Первичная
предобработка данных была выполнена в Департаменте больших данных и
информационного поиска НИУ ВШЭ.

Выборка включала респондентов в возрасте от 42 до 95 лет, разделённых на
группы: здоровые, лица с лёгкими когнитивными нарушениями (MCI),
пациенты с болезнью Альцгеймера и с деменцией. Для последующего анализа
было необходимо выполнить дополнительную фильтрацию данных, исключив
участников без точных диагнозов, а также объекты с выбросами. В
результате предобработки осталось 377 объектов, из них 293 здоровых
респондента и 84 с когнитивными отклонениями

![Диаграмма распределения диагнозов среди респондентов с когнетивными
отклонениями](graphics/graphics/eilers.png)

На следующем этапе для каждого респондента была вычислена матрица
корреляций Пирсона, отражающая степень связности между различными
отделами мозга

Наименования регионов были извлечены из файла, прилагаемого к исходным
данным.

На основе полученных корреляционных матриц был построен полный,
взвешенный и неориентированный граф. В данном графе вершины
соответствовали областям мозга, а рёбра -- значениям корреляций между
ними. Алгоритм построения итогового функционального графа включал два
ключевых этапа:

1.  Выделение наиболее значимых рёбер посредством построения
    **максимального** остовного дерева (MST) с использованием алгоритма
    Крускала.

2.  Добавление оставшихся рёбер, отсортированных по убыванию веса,
    итеративно к MST до достижения порогового значения, заданного
    параметром функции (пример двумерного графа представлен на
    рис. [2](#fig:by_graph){reference-type="ref"
    reference="fig:by_graph"}) (Samal A. 2022).

Кроме того, была построена трехмерная визуализация связей.

![Функциональный граф одного из
респондентов.](graphics/graphics/graph_1.png)

## Вычисление кривизн

На третьем этапе исследования проводился расчёт кривизн графа.

Для обоих типов кривизн использовались следующие параметры:

- В качестве веса ребра $w_{e(v_1, v_2)}$ была взята величина
  $1 - |corr(v_1, v_2)|$, что отражает основную идею: чем сильнее
  корреляция, тем "выгоднее" данное ребро, так как оно обеспечивает
  более короткий путь. Абсолютное значение используется, поскольку как
  положительная, так и отрицательная сильная корреляция указывают на
  значимые зависимости между отделами мозга.

- В качестве веса вершины использовалась её степень.

- Кривизна вершины рассчитывалась как сумма кривизн всех инцидентных ей
  рёбер.

Сначала был реализован алгоритм вычисления кривизны Формана--Риччи.
Отдельно рассчитывались кривизны для рёбер и вершин, кривизна рёбер
определялась согласно
формуле ([\[eq:forman\]](#eq:forman){reference-type="ref"
reference="eq:forman"}).

Затем была реализована функция, вычисляющая кривизны Оливье--Риччи. Для
подсчета кривизн рёбер использовалась
формула ([\[eq:ollivier\]](#eq:ollivier){reference-type="ref"
reference="eq:ollivier"}). Для нахождения расстояния Васерштейна
применялась библиотека POT (Python Optimal Transport), а именно функции
`emd2` и `sinkhorn2` для точного и приближённого расчёта соответственно.
Для расчёта распределений $m_x$ и $m_y$ использовалась
формула ([\[eq:ollivier_m_x\]](#eq:ollivier_m_x){reference-type="ref"
reference="eq:ollivier_m_x"}) в соответствии с (Chien-Chun Ni and Gao
2019). Длины рёбер $d(x, y)$ также определялись как
$1 - |corr(v_1, v_2)|$, что подчёркивает значимость связей с высокой
корреляцией, так как такие рёбра должны быть "ближе" в графе.

Для удобства обработки данных был разработан класс для респондентов,
позволяющий компактно хранить и обновлять все ключевые характеристики. В
него вошли следующие параметры: диагнозы респондента, матрица
корреляций, функциональный граф, метод построения графа (с заданной
плотностью), вычисления кривизн Оливье и Формана--Риччи и другие
необходимые данные.

## Анализ зависимости средних кничений кривизн от плотности графа

Ключевым этапом работы стало применение метода, описанного в
статье (Samal A. 2022), для оценки его применимости к данным,
используемым в настоящей работе, а также для анализа потенциала
улучшения существующих методов диагностики болезни Альцгеймера,
результаты которых представлены в статье (M. O. Zubrikhinaa 2023). Для
каждого респондента была составлена таблица, показывающая зависимость
среднего значения кривизны от плотности графа. Процесс построения
таблицы включал следующие этапы:

1.  Для каждой плотности рёбер (от 2% до 60%, с шагом 1) строился
    отдельный граф.

2.  Для каждого графа рассчитывались кривизны по формулам Оливье--Риччи
    и Формана--Риччи.

3.  Для каждого значения плотности вычислялось среднее значение кривизны
    по рёбрам (сумма значений всех рёбер делится на их количество).

4.  Для каждой вершины рассчитывалось значение AUC (площадь под графиком
    зависимости значения кривизны вершины от плотности графа).

В результате для каждого респондента были получены две таблицы,
содержащие:

1.  Среднее значение кривизны Формана--Риччи рёбер для каждой плотности.

2.  Среднее значение кривизны Оливье--Риччи рёбер для каждой плотности.

3.  Среднее значение кривизны Формана--Риччи для каждой вершины при
    различной плотности.

4.  Среднее значение кривизны Оливье--Риччи для каждой вершины при
    различной плотности.

В связи с большим объёмом данных, на данном этапе работы потребовалось
исследование методов многопоточности на языке Python. Для решения задачи
был использован модуль multiprocessing, а именно его функции Pool и
get_context.

Далее был проведён статистический анализ результатов. Для каждой
плотности графа и каждой вершины по всем респондентам (значения кривизн
для всех участников были объединены в два вектора) выполнены тесты
значимости. Первоначально для каждой выборки проводилась проверка на
соответствие нормальному распределению. В случаях, когда оба вектора
имели нормальное распределение, использовался t-тест (с учётом равенства
дисперсий), в противном случае применялся критерий Манна--Уитни U.

  ------------------ ----------------- --------------- -----------------
  **FRC**                              **ORC**         
  **NodeID**         **p_value_raw**   **NodeID**      **p_value_raw**
  Vermis_3           0.001364          Vermis_3        0.009886
  Lingual_L          0.001758          Cuneus_L        0.015487
  Cingulate_Post_L   0.007519          Postcentral_R   0.022409
  Thal_VL_L          0.009854          Lingual_L       0.024422
  Cuneus_L           0.010149          Lingual_R       0.026128
  ------------------ ----------------- --------------- -----------------

  : Топ-5 наиболее значимых регионов мозга по значению $p$ для кривизн
  FRC и ORC.
:::

На первоначальном этапе анализа были выявлены области с $p-value<0.01$,
что указывало на статистически значимые различия между выборками
(Таблица [1](#table:top_regions_frc_orc){reference-type="ref"
reference="table:top_regions_frc_orc"}). Однако, поскольку проводилось
множественное тестирование, для контроля уровня ложных открытий была
применена коррекция False Discovery Rate (FDR) (Samal A. 2022). После
корректировки различия между выборками утратили статистическую
значимость ( [3](#fig:by_out){reference-type="ref"
reference="fig:by_out"}, [4](#fig:by_vertex){reference-type="ref"
reference="fig:by_vertex"}).

![Графики зависимости кривизны на ребрах от плотности
графа.](graphics/graphics/output.png){#fig:by_out width="80%"}

![Диаграмма различий средних значений кривизн
вершин.](graphics/graphics/vertex.png){#fig:by_vertex width="80%"}

## Метрики и кластеризация

Для дальнейшего анализа было решено применить альтернативный подход ---
рассчитать различные метрики расстояний для векторов, сформированных на
основе значений кривизн вершин, и провести их кластеризацию.

На основании изучения различных метрик были выбраны следующие меры
расстояния:

- Манхэттенское расстояние
  (L1-норма) ([\[eq:manh\]](#eq:manh){reference-type="ref"
  reference="eq:manh"})

- Евклидово расстояние
  (L2-норма) ([\[eq:eucl\]](#eq:eucl){reference-type="ref"
  reference="eq:eucl"})

- Корреляционное расстояние (1 --- коэффициент
  Пирсона) ([\[eq:corr\]](#eq:corr){reference-type="ref"
  reference="eq:corr"})

- Расстояние Канберра: ([\[eq:canber\]](#eq:canber){reference-type="ref"
  reference="eq:canber"})

- Расстояние Минковского (обобщение L1 и L2, здесь
  $p=3$) ([\[eq:mink\]](#eq:mink){reference-type="ref"
  reference="eq:mink"})

Вычисления проводились частично вручную, частично с использованием
библиотеки `scipy.spatial.distance`. Для каждого респондента были
сформированы векторы значений двух типов кривизн, на основании которых
строились матрицы расстояний между респондентами, в зависимости от
выбранной метрики.

Для кластеризации данных были реализованы три метода: K-means, K-Medoids
и HDBSCAN. Алгоритмы K-means и K-Medoids были взяты из библиотек
`sklearn.cluster` и `sklearn_extra.cluster`, а для HDBSCAN
использовалась специализированная библиотека `hdbscan`.

Для оптимизации вычислений применялось распараллеливание, что позволило
перебрать все возможные комбинации типов кривизн, метрик, методов
кластеризации и количества кластеров (от 2 до 4, что соответствовало
либо разделению на больных и здоровых, либо группировке по диагнозам).

Оценка качества кластеризации проводилась с использованием следующих
метрик:

1.  Confusion matrix -- матрица ошибок классификации.

2.  Adjusted Rand Index (ARI) -- показатель степени соответствия двух
    кластеризаций с учётом случайных совпадений, принимает значения в
    диапазоне \[−1,1\].

3.  Normalized Mutual Information (NMI) -- мера, оценивающая, насколько
    информация одной кластеризации предсказывает эталонную разметку,
    принимает значения в диапазоне \[0,1\].

Наилучшие полученные значения показателей качества составили 0.034646
для ARI и 0.013615 для NMI, что свидетельствует об отсутствии
статистически значимых различий между кластерами и указывает на низкую
информативность выбранных признаков.

# Заключение

В ходе проведенного исследования была предпринята попытка классификации
состояний работы мозга на основе данных МРТ с использованием дискретной
кривизны. Изначальная гипотеза о возможности улучшения точности
диагностики когнитивных нарушений на ранних стадиях посредством анализа
корреляций областей мозга не получила подтверждения.

Полученные результаты могут быть обусловлены несколькими факторами.
Во-первых, ограниченный объем выборки мог не обеспечить достаточной
статистической мощности для выявления значимых различий между группами.
Во-вторых, вычислительные мощности, доступные для проведения
исследования, могли оказаться недостаточными для обработки и анализа
большего количества характеристик, что ограничило возможности
оптимизации модели.

В дальнейшем целесообразно увеличить объем выборки и рассмотреть
возможность использования более мощных вычислительных ресурсов для
проведения более глубокого анализа данных и подбора оптимальных
параметров модели. Также перспективным направлением является
исследование других методов машинного обучения и их комбинаций для
повышения точности классификации состояний работы мозга.